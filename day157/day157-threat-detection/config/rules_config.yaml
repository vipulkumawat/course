detection_rules:
  sql_injection:
    - name: "Basic SQL Injection"
      pattern: "(?i)(union.*select|insert.*into|drop.*table|select.*from|delete.*from)"
      severity: "HIGH"
      category: "web_attack"
      action: "block_and_alert"
    
    - name: "Advanced SQL Injection"
      pattern: "(?i)(exec(\\s|\\+)+(s|x)p\\w+|'\\s*or\\s*'1'\\s*=\\s*'1)"
      severity: "CRITICAL"
      category: "web_attack"
      action: "block_and_alert"
  
  xss_attack:
    - name: "Basic XSS"
      pattern: "(?i)(<script[^>]*>.*?</script>|javascript:|onerror=|onload=)"
      severity: "HIGH"
      category: "web_attack"
      action: "block_and_alert"
    
    - name: "Advanced XSS"
      pattern: "(?i)(eval\\(|expression\\(|<iframe|<embed|<object)"
      severity: "HIGH"
      category: "web_attack"
      action: "alert"
  
  brute_force:
    - name: "Failed Login Pattern"
      pattern: "failed.*login|authentication.*failed|invalid.*password"
      severity: "MEDIUM"
      category: "auth_attack"
      action: "track_and_alert"
      threshold: 5
      time_window: 60
    
    - name: "Distributed Brute Force"
      pattern: "failed.*login"
      severity: "CRITICAL"
      category: "auth_attack"
      action: "block_and_alert"
      threshold: 3
      distributed: true
  
  command_injection:
    - name: "Shell Command Injection"
      pattern: "(?i)(;|\\||&&|\\$\\(|`)(cat|ls|wget|curl|bash|sh|cmd|powershell)"
      severity: "CRITICAL"
      category: "system_attack"
      action: "block_and_alert"
  
  path_traversal:
    - name: "Directory Traversal"
      pattern: "(\\.\\./|\\.\\.\\/|%2e%2e%2f|%252e%252e%252f)"
      severity: "HIGH"
      category: "file_attack"
      action: "block_and_alert"
  
  data_exfiltration:
    - name: "Large Data Transfer"
      pattern: "transfer.*size|download.*bytes"
      severity: "MEDIUM"
      category: "data_leak"
      action: "alert"
      threshold: 1073741824  # 1GB

thresholds:
  log_processing_rate: 1000  # logs per second
  alert_latency_ms: 10
  false_positive_rate: 0.05
  
monitoring:
  metrics_interval: 10
  dashboard_port: 8000
  websocket_port: 8001
