name: data_exfiltration_response
description: Response to data exfiltration detection
severity: critical
triggers:
  - data_exfiltration

actions:
  - name: block_external_ip
    type: block_ip
    parameters:
      ip_address: ${destination_ip}
      duration: 86400
    timeout: 10
  
  - name: isolate_affected_system
    type: isolate_system
    parameters:
      system_id: ${system_id}
      preserve_logging: true
    timeout: 20
  
  - name: suspend_user_account
    type: suspend_account
    parameters:
      user_id: ${user_id}
      reason: Data exfiltration detected
    timeout: 15
  
  - name: preserve_logs
    type: preserve_logs
    parameters:
      log_sources: ['network', 'application', 'security']
      time_range_hours: 24
    timeout: 30
  
  - name: create_forensic_snapshot
    type: create_snapshot
    parameters:
      system_id: ${system_id}
      include_memory: true
    timeout: 60
  
  - name: alert_security_team
    type: create_pagerduty
    parameters:
      service_id: security_team
      urgency: high
    timeout: 10
