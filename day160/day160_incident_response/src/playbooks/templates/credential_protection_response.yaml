name: credential_protection_response
description: Response to credential stuffing attacks
severity: high
triggers:
  - credential_stuffing

actions:
  - name: block_attacker_ip
    type: block_ip
    parameters:
      ip_address: ${source_ip}
      duration: 7200
    timeout: 10
  
  - name: force_password_reset
    type: force_password_reset
    parameters:
      user_ids: ${affected_users}
    timeout: 15
  
  - name: revoke_user_sessions
    type: revoke_sessions
    parameters:
      user_id: ${target_user}
    timeout: 10
  
  - name: alert_security_team
    type: send_email_alert
    parameters:
      recipients: ['security@company.com']
      subject: 'Credential Stuffing Attack Detected'
      priority: high
    timeout: 10
  
  - name: preserve_authentication_logs
    type: preserve_logs
    parameters:
      log_sources: ['authentication', 'security']
      time_range_hours: 2
    timeout: 30
