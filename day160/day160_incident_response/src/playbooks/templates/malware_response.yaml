name: malware_response
description: Response to malware detection
severity: critical
triggers:
  - malware_detected

actions:
  - name: isolate_infected_system
    type: isolate_system
    parameters:
      system_id: ${system_id}
      preserve_logging: true
    timeout: 20
    max_retries: 2
  
  - name: capture_network_traffic
    type: capture_traffic
    parameters:
      system_id: ${system_id}
      duration: 600
    timeout: 15
  
  - name: create_forensic_snapshot
    type: create_snapshot
    parameters:
      system_id: ${system_id}
      include_memory: true
    timeout: 60
  
  - name: suspend_user_account
    type: suspend_account
    parameters:
      user_id: ${user_id}
      reason: Malware detected on user system
    timeout: 15
  
  - name: create_pagerduty_incident
    type: create_pagerduty
    parameters:
      service_id: security_team
      urgency: high
    timeout: 10
  
  - name: send_slack_notification
    type: send_slack_alert
    parameters:
      channel: '#security-critical'
      mention_team: true
    timeout: 10
