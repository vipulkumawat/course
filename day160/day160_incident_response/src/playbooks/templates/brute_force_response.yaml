name: brute_force_response
description: Response to brute force authentication attacks
severity: high
triggers:
  - brute_force_attack
  - credential_stuffing

actions:
  - name: block_attacker_ip
    type: block_ip
    parameters:
      ip_address: ${source_ip}
      duration: 7200
    timeout: 10
    max_retries: 2
  
  - name: suspend_targeted_accounts
    type: suspend_account
    parameters:
      user_id: ${target_user}
      reason: Brute force attack detected
    conditions:
      - field: failed_attempts
        operator: greater_than
        value: 10
    timeout: 15
    max_retries: 1
  
  - name: alert_security_team
    type: send_email_alert
    parameters:
      recipients: ['security@company.com']
      subject: 'Brute Force Attack Detected'
      priority: high
    timeout: 10
  
  - name: preserve_attack_logs
    type: preserve_logs
    parameters:
      log_sources: ['authentication', 'security']
      time_range_hours: 2
    timeout: 30
