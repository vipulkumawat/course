name: c2_communication_response
description: Response to C2 (Command & Control) communication detection
severity: critical
triggers:
  - c2_communication

actions:
  - name: block_c2_server
    type: block_ip
    parameters:
      ip_address: ${c2_ip}
      duration: 86400
    timeout: 10
  
  - name: isolate_compromised_host
    type: isolate_system
    parameters:
      system_id: ${system_id}
      preserve_logging: true
    timeout: 20
  
  - name: capture_c2_traffic
    type: capture_traffic
    parameters:
      system_id: ${system_id}
      duration: 300
    timeout: 15
  
  - name: create_system_snapshot
    type: create_snapshot
    parameters:
      system_id: ${system_id}
      include_memory: true
    timeout: 60
  
  - name: collect_forensic_artifacts
    type: collect_artifacts
    parameters:
      system_id: ${system_id}
      artifact_types: ['processes', 'network', 'files']
    timeout: 45
  
  - name: alert_incident_response
    type: create_pagerduty
    parameters:
      service_id: incident_response
      urgency: high
    timeout: 10
  
  - name: notify_security_operations
    type: send_email_alert
    parameters:
      recipients: ['soc@company.com', 'ciso@company.com']
      subject: 'Critical: C2 Communication Detected'
      priority: critical
    timeout: 10
